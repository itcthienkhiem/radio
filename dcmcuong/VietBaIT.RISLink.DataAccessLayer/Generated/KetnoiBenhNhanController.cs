using System; 
using System.Text; 
using System.Data;
using System.Data.SqlClient;
using System.Data.Common;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Configuration; 
using System.Xml; 
using System.Xml.Serialization;
using SubSonic; 
using SubSonic.Utilities;
// <auto-generated />
namespace VietBaIT.RISLink.DataAccessLayer
{
    /// <summary>
    /// Controller class for KETNOI_BENH_NHAN
    /// </summary>
    [System.ComponentModel.DataObject]
    public partial class KetnoiBenhNhanController
    {
        // Preload our schema..
        KetnoiBenhNhan thisSchemaLoad = new KetnoiBenhNhan();
        private string userName = String.Empty;
        protected string UserName
        {
            get
            {
				if (userName.Length == 0) 
				{
    				if (System.Web.HttpContext.Current != null)
    				{
						userName=System.Web.HttpContext.Current.User.Identity.Name;
					}
					else
					{
						userName=System.Threading.Thread.CurrentPrincipal.Identity.Name;
					}
				}
				return userName;
            }
        }
        [DataObjectMethod(DataObjectMethodType.Select, true)]
        public KetnoiBenhNhanCollection FetchAll()
        {
            KetnoiBenhNhanCollection coll = new KetnoiBenhNhanCollection();
            Query qry = new Query(KetnoiBenhNhan.Schema);
            coll.LoadAndCloseReader(qry.ExecuteReader());
            return coll;
        }
        [DataObjectMethod(DataObjectMethodType.Select, false)]
        public KetnoiBenhNhanCollection FetchByID(object HisIdBnhan)
        {
            KetnoiBenhNhanCollection coll = new KetnoiBenhNhanCollection().Where("HIS_ID_BNHAN", HisIdBnhan).Load();
            return coll;
        }
		
		[DataObjectMethod(DataObjectMethodType.Select, false)]
        public KetnoiBenhNhanCollection FetchByQuery(Query qry)
        {
            KetnoiBenhNhanCollection coll = new KetnoiBenhNhanCollection();
            coll.LoadAndCloseReader(qry.ExecuteReader()); 
            return coll;
        }
        [DataObjectMethod(DataObjectMethodType.Delete, true)]
        public bool Delete(object HisIdBnhan)
        {
            return (KetnoiBenhNhan.Delete(HisIdBnhan) == 1);
        }
        [DataObjectMethod(DataObjectMethodType.Delete, false)]
        public bool Destroy(object HisIdBnhan)
        {
            return (KetnoiBenhNhan.Destroy(HisIdBnhan) == 1);
        }
        
        
        
        [DataObjectMethod(DataObjectMethodType.Delete, true)]
        public bool Delete(int HisIdBnhan,string HisMaLanKham,string HisMaPhieu)
        {
            Query qry = new Query(KetnoiBenhNhan.Schema);
            qry.QueryType = QueryType.Delete;
            qry.AddWhere("HisIdBnhan", HisIdBnhan).AND("HisMaLanKham", HisMaLanKham).AND("HisMaPhieu", HisMaPhieu);
            qry.Execute();
            return (true);
        }        
       
    	
    	
	    /// <summary>
	    /// Inserts a record, can be used with the Object Data Source
	    /// </summary>
        [DataObjectMethod(DataObjectMethodType.Insert, true)]
	    public void Insert(int HisIdBnhan,string HisMaLanKham,string HisSoBa,string HisMaPhieu,string HisMaBenh,string HisChanDoan,string HisMaDtuong,string HisSoBhyt,string HisDiaChi,string HisGtinh,int? HisNamSinh,int? HisIdKhoa,string HisTenKhoa,int? HisIdPhong,string HisTenPhong,int? HisIdGiuong,string HisTenGiuong,int? HisTrangThai,DateTime? HisNgayYeucau,DateTime? HisNgayTao,string HisNguoiTao)
	    {
		    KetnoiBenhNhan item = new KetnoiBenhNhan();
		    
            item.HisIdBnhan = HisIdBnhan;
            
            item.HisMaLanKham = HisMaLanKham;
            
            item.HisSoBa = HisSoBa;
            
            item.HisMaPhieu = HisMaPhieu;
            
            item.HisMaBenh = HisMaBenh;
            
            item.HisChanDoan = HisChanDoan;
            
            item.HisMaDtuong = HisMaDtuong;
            
            item.HisSoBhyt = HisSoBhyt;
            
            item.HisDiaChi = HisDiaChi;
            
            item.HisGtinh = HisGtinh;
            
            item.HisNamSinh = HisNamSinh;
            
            item.HisIdKhoa = HisIdKhoa;
            
            item.HisTenKhoa = HisTenKhoa;
            
            item.HisIdPhong = HisIdPhong;
            
            item.HisTenPhong = HisTenPhong;
            
            item.HisIdGiuong = HisIdGiuong;
            
            item.HisTenGiuong = HisTenGiuong;
            
            item.HisTrangThai = HisTrangThai;
            
            item.HisNgayYeucau = HisNgayYeucau;
            
            item.HisNgayTao = HisNgayTao;
            
            item.HisNguoiTao = HisNguoiTao;
            
	    
		    item.Save(UserName);
	    }
    	
	    /// <summary>
	    /// Updates a record, can be used with the Object Data Source
	    /// </summary>
        [DataObjectMethod(DataObjectMethodType.Update, true)]
	    public void Update(int HisIdBnhan,string HisMaLanKham,string HisSoBa,string HisMaPhieu,string HisMaBenh,string HisChanDoan,string HisMaDtuong,string HisSoBhyt,string HisDiaChi,string HisGtinh,int? HisNamSinh,int? HisIdKhoa,string HisTenKhoa,int? HisIdPhong,string HisTenPhong,int? HisIdGiuong,string HisTenGiuong,int? HisTrangThai,DateTime? HisNgayYeucau,DateTime? HisNgayTao,string HisNguoiTao)
	    {
		    KetnoiBenhNhan item = new KetnoiBenhNhan();
	        item.MarkOld();
	        item.IsLoaded = true;
		    
			item.HisIdBnhan = HisIdBnhan;
				
			item.HisMaLanKham = HisMaLanKham;
				
			item.HisSoBa = HisSoBa;
				
			item.HisMaPhieu = HisMaPhieu;
				
			item.HisMaBenh = HisMaBenh;
				
			item.HisChanDoan = HisChanDoan;
				
			item.HisMaDtuong = HisMaDtuong;
				
			item.HisSoBhyt = HisSoBhyt;
				
			item.HisDiaChi = HisDiaChi;
				
			item.HisGtinh = HisGtinh;
				
			item.HisNamSinh = HisNamSinh;
				
			item.HisIdKhoa = HisIdKhoa;
				
			item.HisTenKhoa = HisTenKhoa;
				
			item.HisIdPhong = HisIdPhong;
				
			item.HisTenPhong = HisTenPhong;
				
			item.HisIdGiuong = HisIdGiuong;
				
			item.HisTenGiuong = HisTenGiuong;
				
			item.HisTrangThai = HisTrangThai;
				
			item.HisNgayYeucau = HisNgayYeucau;
				
			item.HisNgayTao = HisNgayTao;
				
			item.HisNguoiTao = HisNguoiTao;
				
	        item.Save(UserName);
	    }
    }
}
